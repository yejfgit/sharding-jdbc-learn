package com.netease.okr.util;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.LinkedList;
import java.util.List;

public class CopyFileTool {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		String inFile = "E:/bjp/"; // 输入文件路径
        String outFile = "E:/bjpout/"; // 输出文件路径
		
		
		traverseFolder1(inFile,outFile);
        
        //System.out.println(getExtention("adfasdfas.jpg"));
	}
	
	 public static void copyFile(String oldPath, String newPath) { 
	       try { 
	           int bytesum = 0; 
	           int byteread = 0; 
	           File oldfile = new File(oldPath); 
	          /* File newPathF = new File(newPath);
	           
	           if(!newPathF.exists()){
	        	   newPathF.createNewFile();
	           }*/
	           
	           if (oldfile.exists()) {                  //文件存在时 
	        	   System.out.println(oldPath+"--------------------------------------------------------"+newPath);
	               InputStream inStream = new FileInputStream(oldPath);      //读入原文件 
	               FileOutputStream fs = new FileOutputStream(newPath); 
	               byte[] buffer = new byte[1444]; 
	               int length; 
	               while ( (byteread = inStream.read(buffer)) != -1) { 
	                   bytesum += byteread;            //字节数 文件大小 
	                   //System.out.println(bytesum); 
	                   fs.write(buffer, 0, byteread); 
	               } 
	               inStream.close(); 
	           } 
	       }  catch (Exception e) { 
	           System.out.println("复制单个文件操作出错"); 
	           e.printStackTrace(); 
	       } 
	   } 
	
	
	public static void  traverseFolder1(String path,String outfile ) {
        int fileNum = 0, folderNum = 0,notConNum = 0,copeNum = 0;
        File file = new File(path);
        if (file.exists()) {
            LinkedList<File> list = new LinkedList<File>();
            File[] files = file.listFiles();
            for (File file2 : files) {
                if (file2.isDirectory()) {
                    System.out.println("文件夹:" + file2.getAbsolutePath());
                    list.add(file2);
                    fileNum++;
                } else {
                	if(isContain(file2.getName())){
                		if(file2.getName().contains("(2)")||file2.getName().contains("(3)")){
                			copyFile(file2.getAbsolutePath(),outfile+file2.getName());
                		}else{
                			String up = getContain(file2.getName());
                			
                			//System.out.println(file2.getName()+"--------------------------------------------------------"+up);
                			
                			copyFile(file2.getAbsolutePath(),outfile+up+getExtention(file2.getName()));
                		}
                		
                		//file2.delete();
                		copeNum++;
                	}else{
                		//System.out.println("文件:" + file2.getName()+"不在表格工号中");
                		notConNum++;
                	}
                	
                    
                    folderNum++;
                }
            }
            /*File temp_file;
            while (!list.isEmpty()) {
                temp_file = list.removeFirst();
                files = temp_file.listFiles();
                for (File file2 : files) {
                    if (file2.isDirectory()) {
                        System.out.println("文件夹:" + file2.getAbsolutePath());
                        list.add(file2);
                        fileNum++;
                    } else {
                        System.out.println("文件:" + file2.getAbsolutePath());
                        folderNum++;
                    }
                }
            }*/
        } else {
            //System.out.println("文件不存在!");
        }
        System.out.println("文件夹共有:" + folderNum + ",文件共有:" + fileNum+",excel不包含工号数："+notConNum+",成功复制数："+copeNum);

    }
	
	private static boolean isContain(String str){
		List<String> lst = getList();
		
		for(int i=0;i<lst.size();i++){
			String constr = lst.get(i);
			if(str.contains(constr)){
				System.out.println(str+"--------------------------------------------------------"+constr);
				return true;
			}
		}
		
		return false;
	}
	
	private static String getContain(String str){
		List<String> lst = getList();
		
		for(int i=0;i<lst.size();i++){
			String constr = lst.get(i);
			if(str.contains(constr)){
				
				return constr;
			}
		}
		return null;
	}
	
	
	public static String getExtention(String fileName) {
		int pos = fileName.lastIndexOf(".");
		return fileName.substring(pos);
	}
	
	
	private static List<String>  getList(){
		return new ArrayList<String>(Arrays.asList(
				"B0098",
				"B0179",
				"B0207",
				"B0268",
				"B0289",
				"B0394",
				"B0406",
				"B0420",
				"B0438",
				"B0457",
				"B0510",
				"B0523",
				"B0558",
				"B0606",
				"B0663",
				"B0678",
				"B0723",
				"B0745",
				"B0774",
				"B0804",
				"B0820",
				"B0836",
				"B0837",
				"B0840",
				"B0859",
				"B0878",
				"B0939",
				"B0946",
				"B0954",
				"B0974",
				"B0978",
				"B0987",
				"B0989",
				"B1003",
				"B1012",
				"B1016",
				"B1023",
				"B1029",
				"B1037",
				"B1053",
				"B1077",
				"B1089",
				"B1098",
				"B1146",
				"B1147",
				"B1149",
				"B1157",
				"B1166",
				"B1187",
				"B1189",
				"B1212",
				"B1225",
				"B1265",
				"B1279",
				"B1300",
				"B1302",
				"B1306",
				"B1315",
				"B1318",
				"B1325",
				"B1352",
				"B1386",
				"B1415",
				"B1436",
				"B1437",
				"B1516",
				"B1518",
				"B1542",
				"B1548",
				"B1563",
				"B1570",
				"B1592",
				"B1604",
				"B1618",
				"B1630",
				"B1650",
				"B1672",
				"B1684",
				"B1702",
				"B1703",
				"B1715",
				"B1720",
				"B1733",
				"B1769",
				"B1770",
				"B1785",
				"B1797",
				"B1806",
				"B1815",
				"B1828",
				"B1839",
				"B1870",
				"B1871",
				"B1888",
				"B1899",
				"B1914",
				"B1921",
				"B1930",
				"B1931",
				"B1943",
				"B1946",
				"B1948",
				"B1952",
				"B1956",
				"B1962",
				"B1973",
				"B1974",
				"B1979",
				"B1980",
				"B1983",
				"B1989",
				"B1992",
				"B1993",
				"B2018",
				"B2027",
				"B2046",
				"B2076",
				"B2077",
				"B2082",
				"B2101",
				"B2108",
				"B2119",
				"B2159",
				"B2163",
				"B2171",
				"B2184",
				"B2189",
				"B2207",
				"B2209",
				"B2214",
				"B2230",
				"B2233",
				"B2247",
				"B2253",
				"B2276",
				"B2290",
				"B2303",
				"B2305",
				"B2316",
				"B2319",
				"B2327",
				"B2329",
				"B2348",
				"B2358",
				"B2362",
				"B2363",
				"B2387",
				"B2393",
				"B2399",
				"B2417",
				"B2447",
				"B2448",
				"B2478",
				"B2485",
				"B2488",
				"B2510",
				"B2513",
				"B2514",
				"B2536",
				"B2541",
				"B2568",
				"B2578",
				"B2581",
				"B2587",
				"B2598",
				"B2605",
				"B2621",
				"B2625",
				"B2631",
				"B2662",
				"B2664",
				"B2683",
				"B2697",
				"B2715",
				"B2717",
				"B2726",
				"B2756",
				"B2764",
				"B2775",
				"B2807",
				"B2815",
				"B2824",
				"B2827",
				"B2840",
				"B2844",
				"B2849",
				"B2866",
				"B2877",
				"B2903",
				"B2906",
				"B2919",
				"B2939",
				"B2940",
				"B2946",
				"B2949",
				"B2969",
				"B2973",
				"B2985",
				"B2993",
				"B3008",
				"B3024",
				"B3028",
				"B3046",
				"B3052",
				"B3053",
				"B3060",
				"B3067",
				"B3073",
				"B3094",
				"B3095",
				"B3107",
				"B3109",
				"B3115",
				"B3123",
				"B3139",
				"B3144",
				"B3184",
				"B3188",
				"B3189",
				"B3198",
				"B3231",
				"B3233",
				"B3236",
				"B3240",
				"B3247",
				"B3274",
				"B3281",
				"B3284",
				"B3291",
				"B3293",
				"B3298",
				"B3303",
				"B3322",
				"B3324",
				"B3332",
				"B3335",
				"B3347",
				"B3349",
				"B3366",
				"B3367",
				"B3381",
				"B3391",
				"B3394",
				"B3421",
				"B3426",
				"B3441",
				"B3459",
				"B3461",
				"B3475",
				"B3476",
				"B3479",
				"B3496",
				"B3501",
				"B3502",
				"B3516",
				"B3533",
				"B3537",
				"B3542",
				"B3563",
				"B3572",
				"B3577",
				"B3583",
				"B3596",
				"B3623",
				"B3627",
				"B3629",
				"B3630",
				"B3631",
				"B3633",
				"B3670",
				"B3682",
				"B3689",
				"B3692",
				"B3697",
				"B3700",
				"B3727",
				"B3729",
				"B3739",
				"B3744",
				"B3757",
				"B3758",
				"B3764",
				"B3770",
				"B3786",
				"B3795",
				"B3796",
				"B3807",
				"B3810",
				"B3811",
				"B3814",
				"B3818",
				"B3827",
				"B3828",
				"B3836",
				"B3837",
				"B3838",
				"B3845",
				"B3853",
				"B3858",
				"B3859",
				"B3864",
				"B3873",
				"B3886",
				"B3887",
				"B3891",
				"B3893",
				"B3894",
				"B3896",
				"B3897",
				"B3902",
				"B3907",
				"B3911",
				"B3912",
				"B3913",
				"B3915",
				"B3919",
				"B3940",
				"B3945",
				"B3949",
				"B3950",
				"B3956",
				"B3962",
				"B3972",
				"B3976",
				"B3982",
				"B3986",
				"B3987",
				"B3991",
				"B3993",
				"B4006",
				"B4008",
				"B4012",
				"B4021",
				"B4024",
				"B4025",
				"B4027",
				"B4033",
				"B4040",
				"B4049",
				"B4050",
				"B4052",
				"B4074",
				"B4082",
				"B4101",
				"B4102",
				"B4104",
				"B4122",
				"B4123",
				"B4130",
				"B4133",
				"B4135",
				"B4161",
				"B4164",
				"B4180",
				"B4184",
				"B4191",
				"B4200",
				"B4208",
				"B4209",
				"B4215",
				"B4220",
				"B4224",
				"B4232",
				"B4233",
				"B4235",
				"B4246",
				"B4252",
				"B4255",
				"B4260",
				"B4264",
				"B4266",
				"B4270",
				"B4274",
				"B4275",
				"B4276",
				"B4277",
				"B4282",
				"B4288",
				"B4292",
				"B4294",
				"B4295",
				"B4303",
				"B4307",
				"B4308",
				"B4310",
				"B4324",
				"B4349",
				"B4353",
				"B4355",
				"B4365",
				"B4368",
				"B4369",
				"B4378",
				"B4379",
				"B4380",
				"B4390",
				"B4393",
				"B4394",
				"B4396",
				"B4400",
				"B4411",
				"B4412",
				"B4413",
				"B4425",
				"B4426",
				"B4431",
				"B4440",
				"B4442",
				"B4452",
				"B4455",
				"B4460",
				"B4463",
				"B4464",
				"B4477",
				"B4486",
				"B4494",
				"B4500",
				"B4501",
				"B4502",
				"B4511",
				"B4520",
				"B4529",
				"B4531",
				"B4535",
				"B4536",
				"B4545",
				"B4549",
				"B4550",
				"B4557",
				"B4563",
				"B4564",
				"B4565",
				"B4567",
				"B4573",
				"B4579",
				"B4581",
				"B4584",
				"B4600",
				"B4610",
				"B4611",
				"B4618",
				"B4621",
				"B4626",
				"B4633",
				"B4640",
				"B4641",
				"B4657",
				"B4663",
				"B4665",
				"B4668",
				"B4679",
				"B4682",
				"B4684",
				"B4686",
				"B4687",
				"B4690",
				"B4691",
				"B4698",
				"B4701",
				"B4706",
				"B4712",
				"B4713",
				"B4715",
				"B4716",
				"B4719",
				"B4722",
				"B4731",
				"B4733",
				"B4735",
				"B4736",
				"B4737",
				"B4741",
				"B4745",
				"B4746",
				"B4750",
				"B4752",
				"B4754",
				"B4756",
				"B4762",
				"B4765",
				"B4769",
				"B4771",
				"B4772",
				"B4774",
				"B4780",
				"B4783",
				"B4786",
				"B4791",
				"B4794",
				"B4799",
				"B4800",
				"B4810",
				"B4812",
				"B4815",
				"B4818",
				"B4824",
				"B4829",
				"B4831",
				"B4835",
				"B4837",
				"B4845",
				"B4846",
				"B4850",
				"B4854",
				"B4855",
				"B4856",
				"B4863",
				"B4869",
				"B4875",
				"B4886",
				"B4890",
				"B4891",
				"B4892",
				"B4896",
				"B4897",
				"B4899",
				"B4902",
				"B4905",
				"B4911",
				"B4920",
				"B4921",
				"B4926",
				"B4928",
				"B4933",
				"B4935",
				"B4936",
				"B4939",
				"B4940",
				"B4943",
				"B4951",
				"B4952",
				"B4955",
				"B4957",
				"B4961",
				"B4963",
				"B4965",
				"B4966",
				"B4967",
				"B4973",
				"B4975",
				"B4977",
				"B4978",
				"B4983",
				"B4985",
				"B4986",
				"B4990",
				"B4991",
				"B4994",
				"B5002",
				"B5007",
				"B5014",
				"B5018",
				"B5020",
				"B5021",
				"B5024",
				"B5035",
				"B5039",
				"B5040",
				"B5041",
				"B5044",
				"B5045",
				"B5051",
				"B5053",
				"B5054",
				"B5056",
				"B5059",
				"B5060",
				"B5062",
				"B5063",
				"B5077",
				"B5083",
				"B5089",
				"B5097",
				"B5098",
				"B5100",
				"B5102",
				"B5105",
				"B5106",
				"B5107",
				"B5114",
				"B5116",
				"B5121",
				"B5127",
				"B5129",
				"B5130",
				"B5131",
				"B5133",
				"B5134",
				"B5141",
				"B5142",
				"B5147",
				"B5148",
				"B5152",
				"B5155",
				"B5159",
				"B5165",
				"B5169",
				"B5172",
				"B5175",
				"B5177",
				"B5183",
				"B5187",
				"B5188",
				"B5194",
				"B5195",
				"B5201",
				"B5211",
				"B5213",
				"B5214",
				"B5215",
				"B5217",
				"B5222",
				"B5223",
				"B5224",
				"B5227",
				"B5228",
				"B5231",
				"B5239",
				"B5241",
				"B5242",
				"B5243",
				"B5244",
				"B5246",
				"B5248",
				"B5251",
				"B5252",
				"B5259",
				"B5263",
				"B5264",
				"B5265",
				"B5267",
				"B5268",
				"B5270",
				"B5274",
				"B5275",
				"B5278",
				"B5280",
				"B5281",
				"B5284",
				"B5292",
				"B5294",
				"B5297",
				"B5298",
				"B5300",
				"B5304",
				"B5305",
				"B5307",
				"B5308",
				"B5310",
				"B5311",
				"B5312",
				"B5318",
				"B5322",
				"B5328",
				"B5329",
				"B5330",
				"B5332",
				"B5333",
				"B5335",
				"B5343",
				"B5348",
				"B5349",
				"B5350",
				"B5352",
				"B5354",
				"B5355",
				"B5356",
				"B5363",
				"B5370",
				"B5373",
				"B5375",
				"B5376",
				"B5377",
				"B5380",
				"B5383",
				"B5388",
				"B5392",
				"B5396",
				"B5408",
				"B5413",
				"B5417",
				"B5423",
				"B5424",
				"B5425",
				"B5428",
				"B5432",
				"B5433",
				"B5434",
				"B5436",
				"B5438",
				"B5442",
				"B5444",
				"B5445",
				"B5456",
				"B5459",
				"B5460",
				"B5462",
				"B5463",
				"B5466",
				"B5467",
				"B5468",
				"B5475",
				"B5482",
				"B5484",
				"B5490",
				"B5493",
				"B5494",
				"B5495",
				"B5497",
				"B5501",
				"B5505",
				"B5507",
				"B5511",
				"B5512",
				"B5513",
				"B5516",
				"B5518",
				"B5519",
				"B5523",
				"B5527",
				"B5528",
				"B5534",
				"B5535",
				"B5538",
				"B5539",
				"B5542",
				"B5543",
				"B5545",
				"B5547",
				"B5549",
				"B5555",
				"B5557",
				"B5561",
				"B5563",
				"B5564",
				"B5567",
				"B5569",
				"B5570",
				"B5571",
				"B5572",
				"B5573",
				"B5575",
				"B5578",
				"B5581",
				"B5585",
				"B5586",
				"B5587",
				"B5596",
				"B5598",
				"B5609",
				"B5610",
				"B5613",
				"B5617",
				"B5620",
				"B5625",
				"B5626",
				"B5627",
				"B5629",
				"B5630",
				"B5631",
				"B5635",
				"B5636",
				"B5641",
				"B5642",
				"B5646",
				"B5650",
				"B5652",
				"B5653",
				"B5656",
				"B5657",
				"B5660",
				"B5661",
				"B5662",
				"B5664",
				"B5665",
				"B5670",
				"B5675",
				"B5676",
				"B5681",
				"B5682",
				"B5683",
				"B5684",
				"B5685",
				"B5686",
				"B5689",
				"B5690",
				"B5696",
				"B5700",
				"B5702",
				"B5705",
				"B5707",
				"B5711",
				"B5713",
				"B5715",
				"B5724",
				"B5725",
				"B5726",
				"B5728",
				"B5733",
				"B5734",
				"B5736",
				"B5739",
				"B5742",
				"B5747",
				"B5749",
				"B5754",
				"B5755",
				"B5758",
				"B5762",
				"B5766",
				"B5767",
				"B5768",
				"B5773",
				"B5774",
				"B5778",
				"B5779",
				"B5780",
				"B5781",
				"B5786",
				"B5790",
				"B5793",
				"B5794",
				"B5798",
				"B5801",
				"B5808",
				"B5811",
				"B5813",
				"B5814",
				"B5817",
				"B5819",
				"B5820",
				"B5825",
				"B5828",
				"B5829",
				"B5831",
				"B5833",
				"B5838",
				"B5841",
				"B5842",
				"B5851",
				"B5852",
				"B5855",
				"B5856",
				"B5857",
				"B5859",
				"B5860",
				"B5863",
				"B5864",
				"B5868",
				"B5870",
				"B5871",
				"B5874",
				"B5878",
				"B5880",
				"B5883",
				"B5888",
				"B5893",
				"B5896",
				"B5899",
				"B5900",
				"B5901",
				"B5902",
				"B5903",
				"B5904",
				"B5906",
				"B5911",
				"B5915",
				"B5917",
				"B5920",
				"B5923",
				"B5927",
				"B5928",
				"B5935",
				"B5937",
				"B5938",
				"B5939",
				"B5948",
				"B5949",
				"B5950",
				"B5954",
				"B5958",
				"B5961",
				"B5964",
				"B5973",
				"B5977",
				"B5982",
				"B5986",
				"B5987",
				"B5988",
				"B5990",
				"B5992",
				"B5995",
				"B6000",
				"B6004",
				"B6017",
				"B6020",
				"B6021",
				"B6023",
				"B6024",
				"B6025",
				"B6027",
				"B6029",
				"B6035",
				"B6040",
				"B6041",
				"B6043",
				"B6076",
				"B6081",
				"B6082",
				"B6084",
				"B6085",
				"B6090",
				"B6098",
				"B6104",
				"B6114",
				"B6124",
				"B6125",
				"B6304",
				"B6307",
				"B6309",
				"B6312",
				"B6316",
				"B6321",
				"B6323",
				"B6325",
				"B6327",
				"B6333",
				"B6338",
				"B6339",
				"B6341",
				"B6343",
				"B6346",
				"B6350",
				"B6354",
				"B6357",
				"B6364",
				"B6366",
				"B6369",
				"B6374",
				"B6375",
				"B6377",
				"B6381",
				"B6382",
				"B6398",
				"B6401",
				"B6403",
				"B6407",
				"B6408",
				"B6412",
				"B6413",
				"B6414",
				"B6415",
				"B6416",
				"B6417",
				"B6420",
				"B6423",
				"B6428",
				"B6430",
				"B6431",
				"B6432",
				"B6434",
				"B6442",
				"B6444",
				"B6449",
				"B6465",
				"B6469",
				"B6472",
				"B6473",
				"B6479",
				"B6483",
				"B6493",
				"B6498",
				"B6500",
				"B6503",
				"B6517",
				"B6519",
				"B6527",
				"B6529",
				"B6532",
				"B6539",
				"B6556",
				"B6558",
				"B6562",
				"B6566",
				"B6567",
				"B6581",
				"B6585",
				"B6589",
				"B6593",
				"B6594",
				"B6596",
				"B6598",
				"B6604",
				"B6612",
				"B6613",
				"B6614",
				"B6615",
				"B6639",
				"B6647",
				"B6655",
				"B6665",
				"B6675",
				"B6681",
				"B6687",
				"B6714",
				"B6716",
				"B6772",
				"B6818",
				"B6835",
				"B6867",
				"B6897",
				"B6915",
				"B6918",
				"B6928",
				"B6932",
				"B6948",
				"B6960",
				"B6962",
				"B6963",
				"B6968",
				"B6969",
				"B6970",
				"B6973",
				"B6991",
				"B6993",
				"B6995",
				"B7005",
				"B7021",
				"B7025",
				"B7035",
				"B7047",
				"B7048",
				"B7049",
				"B7052",
				"B7053",
				"B7056",
				"B7063",
				"B7065",
				"B7066",
				"B7069",
				"B7071",
				"B7072",
				"B7073",
				"B7074",
				"B7075",
				"B7076",
				"B7080",
				"B7081",
				"B7088",
				"B7089",
				"B7090",
				"B7091",
				"B7094",
				"B7096",
				"B7101",
				"B7108",
				"B7116",
				"B7118",
				"B7123",
				"B7160",
				"B7164",
				"B7170",
				"B7171",
				"B7822",
				"B7824",
				"B7853",
				"B7854",
				"B7855",
				"B7883",
				"B7891",
				"B7907",
				"B7910",
				"B7911",
				"B7912",
				"B7913",
				"B7916",
				"B7917",
				"B7918",
				"B7919",
				"B7920",
				"B7921",
				"B7922",
				"B7923",
				"B7924",
				"B7925",
				"B7926",
				"B7927",
				"B7928",
				"B7929",
				"B7930",
				"B7931",
				"B7933",
				"B7934",
				"B7935",
				"B7936",
				"B7937",
				"B7938",
				"B7939",
				"B7940",
				"B7941",
				"B7942",
				"B7943",
				"B7944",
				"B7945",
				"B7946",
				"B7947",
				"B7948",
				"B7949",
				"B7950",
				"B7951",
				"B7952",
				"B7953",
				"B7954",
				"B7955",
				"B7956",
				"B7957",
				"B7959",
				"B7961",
				"B7962",
				"B7965",
				"B7966",
				"B7967",
				"B7968",
				"B7969",
				"B7970",
				"B7972",
				"B7973",
				"B7974",
				"B7975",
				"B7976",
				"B7977",
				"B7978",
				"B7979",
				"B7981",
				"B7982",
				"B7983",
				"B7984",
				"B7985",
				"B7986",
				"B7987",
				"B7988",
				"B7990",
				"B7991",
				"B7992",
				"B7993",
				"B7994",
				"BJP001",
				"BJP002",
				"BJP004",
				"BJP007",
				"BJP008",
				"BJP009",
				"BJP010",
				"BJP012",
				"BJP014",
				"BJP018",
				"G3435",
				"G3907",
				"H1616",
				"H8812",
				"S1267",
				"WJ026"
				));
		
	}
	
	
	
}
