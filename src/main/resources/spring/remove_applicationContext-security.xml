<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
 	
	<!-- <beans:bean id="authenticationEntryPoint"  class="com.netease.entrant.util.component.AjaxAwareAuthenticationEntryPoint">
	    <beans:constructor-arg name="loginUrl" value="/login"/>
	</beans:bean> -->
	
	<beans:bean id="ajaxTimeoutRedirectFilter" class="com.netease.okr.util.component.AjaxTimeoutRedirectFilter">
		<beans:property name="customSessionExpiredErrorCode" value="403"/>
	</beans:bean>
	
	<http security="none" pattern="/css/**"></http>
	<http security="none" pattern="/img/**"></http>
	<http security="none" pattern="/js/**"></http>
	<http security="none" pattern="/fonts/**"></http>
	<!-- <http security="none" pattern="/login"></http> -->
	<!--<http  use-expressions="true" entry-point-ref="authenticationEntryPoint" >-->
	<http  use-expressions="true" >
		<intercept-url pattern="/*" access="isAuthenticated()" />
		<intercept-url pattern="/entrant_list/**" access="hasAnyRole('R_IT_Engineer','R_IT_Admin','R_HR','R_HR_Admin','R_Super_Admin','R_Entrant_Reviewer')" />
		<intercept-url pattern="/list/**" access="hasAnyRole('R_IT_Engineer','R_IT_Admin','R_HR','R_HR_Admin','R_Super_Admin','R_Entrant_Reviewer')" />

        <custom-filter ref="ajaxTimeoutRedirectFilter" after="EXCEPTION_TRANSLATION_FILTER"/>
        
        <form-login login-page="/login" 
            login-processing-url="/authentication" username-parameter="username" password-parameter="password"
            default-target-url="/index" always-use-default-target="true"
            authentication-failure-url="/login"/>
            
        <logout invalidate-session="true" logout-success-url="/logout"
             delete-cookies="JSESSIONID"/>
             
        <access-denied-handler error-page="/common/403.html"/>
        
        <session-management>
            <concurrency-control max-sessions="1" expired-url="/login"/>
        </session-management>
        
        <!-- <session-management invalid-session-url="/login">
            <concurrency-control max-sessions="1"
                expired-url="/login" />
        </session-management> -->
        
        <remember-me key="e37f4b31-0c45-11dd-bd0b-0800200c9a66"
	        token-validity-seconds="604800"
			/>
        
    </http>
    
 	<authentication-manager>
        <authentication-provider user-service-ref="userDetailServiceImpl">
        	 <password-encoder hash="md5" /> 
        </authentication-provider>
    </authentication-manager> 
 
</beans:beans>
